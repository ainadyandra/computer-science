<!DOCTYPE html>
<html>
<head>
  <title>Computer Science Revision</title>
  <meta charset="UTF-8">
</head>
<body>
  <h1>Computer Science Revision</h1>
  <hr>
  <h2>Binary to Denary</h2>
  <p>Computers only understand 0 (off) and 1 (on).</p>
  <p>Binary is how all data is stored: text, images, sound, programs.</p>
  <p>1 byte = 8 bits</p>
  <div id="binary-game">
    <p><strong>Convert this binary number to denary:</strong></p>
    <p id="binary-number" style="font-size: 1.5em; font-weight: bold;">
      <!-- binary numbers here -->
    </p>
    <input type="number" id="user-answer" placeholder="Enter denary value">
    <button onclick="checkAnswer()">Submit</button>
    <button onclick="generateBinary()">Next</button>
    <p id="feedback"></p>
    <p>Score:<span id="score">0</span></p>
  </div>
  <hr>
  
  <h2>Quick Quizzes</h2>
<div id="quiz-section">
    <p>Select a topic to start the quiz:</p>
    <button onclick="startQuiz('compression')">Compression</button>
    <button onclick="startQuiz('esafety')">E-Safety</button>
    <button onclick="startQuiz('html')">HTML</button>
    <div id="quiz-area"></div>
</div>
<hr>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const binaryEl = document.getElementById('binary-number');
  const feedbackEl = document.getElementById('feedback');
  const userInput = document.getElementById('user-answer');
  const scoreEl = document.getElementById('score');
  const quizzes = {
    compression: [
        {
            q: "What is compression?",
            choices: [
                "Increases file size", 
                "Reduces file size for storage and transfer", 
                "Deletes the file", 
                "Changes file type only"
            ],
            a: 1
        },
        {
            q: "Which is an example of lossy compression?",
            choices: ["JPEG image", "ZIP file", "PNG image", "Text file"],
            a: 0
        },
        {
            q: "Which is an example of lossless compression?",
            choices: ["MP3 audio", "JPEG image", "ZIP file", "MP4 video"],
            a: 2
        }
    ],
    esafety: [
        {
            q: "Which action helps protect privacy online?",
            choices: [
                "Share passwords with friends", 
                "Use strong passwords", 
                "Click unknown links", 
                "Talk to strangers online"
            ],
            a: 1
        },
        {
            q: "If you see cyberbullying online, what should you do?",
            choices: [
                "Ignore it", 
                "Join in", 
                "Report it", 
                "Screenshot and post"
            ],
            a: 2
        }
    ],
    html: [
        {
            q: "What does HTML do?",
            choices: [
                "Designs the webpage style", 
                "Controls structure of webpage", 
                "Stores images", 
                "Runs JavaScript"
            ],
            a: 1
        },
        {
            q: "Which tag creates a hyperlink?",
            choices: ["<a>", "<img>", "<p>", "<div>"],
            a: 0
        },
        {
            q: "Which tag creates a list item?",
            choices: ["<li>", "<ul>", "<ol>", "<list>"],
            a: 0
        }
    ]
};
window.startQuiz = function(topic) {
    if(!quizzes[topic]) return;
    currentQuiz = quizzes[topic];
    currentIndex = 0;
    correctCount = 0;
    showQuestion();
}

window.showQuestion = function() {
    const quizArea = document.getElementById('quiz-area');
    quizArea.innerHTML = '';

    if(currentIndex >= currentQuiz.length){
        quizArea.innerHTML = `<p>You scored ${correctCount} out of ${currentQuiz.length}!</p>
                              <button onclick="startQuiz('${currentQuiz[0]?.topic||'compression'}')">Retry</button>`;
        return;
    }

    const q = currentQuiz[currentIndex];
    const div = document.createElement('div');
    div.innerHTML = `<p><strong>Q${currentIndex+1}:</strong> ${q.q}</p>`;

    q.choices.forEach((choice, i) => {
        const btn = document.createElement('button');
        btn.textContent = choice;
        btn.style.display = 'block';
        btn.style.margin = '4px 0';
        btn.onclick = () => checkAnswer(i);
        div.appendChild(btn);
    });

    quizArea.appendChild(div);
}

window.checkAnswer = function(selectedIndex){
    const q = currentQuiz[currentIndex];
    const quizArea = document.getElementById('quiz-area');

    if(selectedIndex === q.a){
        correctCount++;
        quizArea.innerHTML = `<p>✔ Correct!</p>`;
    } else {
        quizArea.innerHTML = `<p>✘ Wrong! Correct answer: ${q.choices[q.a]}</p>`;
    }

    currentIndex++;
    setTimeout(showQuestion, 1000);
}
let currentQuiz = [];
let currentIndex = 0;
let correctCount = 0;

function startQuiz(topic) {
    if(!quizzes[topic]) return;
    currentQuiz = quizzes[topic];
    currentIndex = 0;
    correctCount = 0;
    showQuestion();
}

function showQuestion() {
    const quizArea = document.getElementById('quiz-area');
    quizArea.innerHTML = '';

    if(currentIndex >= currentQuiz.length){
        quizArea.innerHTML = `<p>You scored ${correctCount} out of ${currentQuiz.length}!</p>
                              <button onclick="startQuiz('${currentQuiz[0]?.topic||'compression'}')">Retry</button>`;
        return;
    }

    const q = currentQuiz[currentIndex];
    const div = document.createElement('div');
    div.innerHTML = `<p><strong>Q${currentIndex+1}:</strong> ${q.q}</p>`;

    q.choices.forEach((choice, i) => {
        const btn = document.createElement('button');
        btn.textContent = choice;
        btn.style.display = 'block';
        btn.style.margin = '4px 0';
        btn.onclick = () => checkAnswer(i);
        div.appendChild(btn);
    });

    quizArea.appendChild(div);
}

function checkAnswer(selectedIndex){
    const q = currentQuiz[currentIndex];
    const quizArea = document.getElementById('quiz-area');

    if(selectedIndex === q.a){
        correctCount++;
        quizArea.innerHTML = `<p>✔ Correct!</p>`;
    } else {
        quizArea.innerHTML = `<p>✘ Wrong! Correct answer: ${q.choices[q.a]}</p>`;
    }

    currentIndex++;
    setTimeout(showQuestion, 1000);
}
  if (!binaryEl) {
    console.error('Missing element: #binary-number. Make sure your HTML has <p id="binary-number"></p>');
    if (feedbackEl) feedbackEl.textContent = 'Error: game not set up correctly (see console).';
    return;
  }

  let score = 0;
  let currentBinary = '';

  // generate a random binary string of length 4..8
  function generateBinary() {
    const length = Math.floor(Math.random() * 5) + 4; // 4..8
    let bin = '';
    for (let i = 0; i < length; i++) {
      bin += Math.random() < 0.5 ? '0' : '1';
    }
    currentBinary = bin;
    binaryEl.textContent = currentBinary;
    if (feedbackEl) feedbackEl.textContent = '';
    if (userInput) userInput.value = '';
    console.log('New binary generated:', currentBinary);
  }

  function checkAnswer() {
    if (currentBinary === '') {
      if (feedbackEl) feedbackEl.textContent = 'No binary number available — click "New Number".';
      console.warn('checkAnswer called but no currentBinary present.');
      return;
    }
    const userValRaw = userInput ? userInput.value : '';
    const userVal = userValRaw === '' ? NaN : Number(userValRaw);
    const correct = parseInt(currentBinary, 2);
    if (Number.isNaN(userVal)) {
      if (feedbackEl) feedbackEl.textContent = 'Please type a number.';
      return;
    }
    if (userVal === correct) {
      score++;
      if (feedbackEl) feedbackEl.textContent = '✔ Correct!';
    } else {
      if (feedbackEl) feedbackEl.textContent = '✘ Wrong! Correct: ' + correct;
    }
    if (scoreEl) scoreEl.textContent = score;
    console.log('Checked answer. user:', userVal, 'correct:', correct, 'score:', score);
  }
  window.generateBinary = generateBinary;
  window.checkAnswer = checkAnswer;
  try {
    generateBinary();
  } catch (err) {
    console.error('Error while generating binary on load:', err);
    if (feedbackEl) feedbackEl.textContent = 'Error generating number — see console.';
  }
});
</script>
</body>
</html>
